# STIG Remediation â€” WN10-00-000175  
**Microsoft Windows 10 STIG V3R1**

---

## Overview

This control requires that the **Secondary Logon service** be disabled.

**STIG Requirement**

> The Secondary Logon service must be disabled.

---

## What It Does

The Secondary Logon service allows users to start processes using alternate credentials (e.g., "Run as different user").

Service Name: `seclogon`

---

## Why This Matters

If enabled:

- Attackers can attempt privilege escalation
- Stolen credentials become easier to use
- Lateral movement risk increases

Disabling the service reduces credential misuse risk.

---

## Technical Details

- **STIG ID:** WN10-00-000175  
- **Service Name:** seclogon  
- **Required Startup Type:** Disabled  
- **Required Status:** Stopped  

---

## Remediation Script

```powershell
<#
.SYNOPSIS
    Disables Secondary Logon service for STIG WN10-00-000175.

.NOTES
    Author          : Chau Pham
    Date Created    : 2026-02-20
    Version         : 1.0
    STIG-ID         : WN10-00-000175

.USAGE
    Run as Administrator:
    PS C:\> .\remediate-WN10-00-000175.ps1
#>

try {
    $service = Get-Service -Name seclogon -ErrorAction Stop

    # Stop service if running
    if ($service.Status -ne "Stopped") {
        Stop-Service -Name seclogon -Force
    }

    # Set startup type to Disabled
    Set-Service -Name seclogon -StartupType Disabled

    # Verify
    $verify = Get-Service -Name seclogon

    if ($verify.Status -eq "Stopped" -and $verify.StartType -eq "Disabled") {
        Write-Output "SUCCESS: Secondary Logon service is disabled."
        exit 0
    }
    else {
        Write-Output "FAIL: Secondary Logon service is not fully disabled."
        exit 1
    }
}
catch {
    Write-Output "ERROR: $($_.Exception.Message)"
    exit 1
}
